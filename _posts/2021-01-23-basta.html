---
permalink: /basta
---
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="Basta">
    <meta name="description" content="Basta: el juego">

    <title>Basta: el juego - eduardogarcia.xyz</title>

    <link
      href="https://fonts.googleapis.com/css?family=Montserrat:300,900&display=swap"
      rel="stylesheet"
    >

    <style type="text/css">
      :root {
        /* https://connect.pantone.com/#/color-of-the-year */
        --p-illuminating: #f5df4d;
        --p-skydiver: #00589b;
        --black: #000000;
        --white: #ffffff;

        --background: var(--p-skydiver);
        --foreground: var(--p-illuminating);
      }

      body,
      button,
      input {
        font-family: "Montserrat", "Helvetica Neue", Helvetica, Arial, sans-serif;
      }

      body {
        margin: 0 10vw 5vw;
        font-size: 16px;
        font-weight: 300;
        transition-property: background-color, border-color, color;
        transition-duration: .333s;
        transition-timing-function: ease-in-out;
      }

      .body--mode-input {
        background-color: var(--background);
        color: var(--foreground);
      }

      .body--mode-roulette {
        background-color: var(--foreground);
        color: var(--background);
      }

      .roulette__letter {
        cursor: pointer;
        text-align: center;
        text-transform: uppercase;
        font-weight: 900;
        font-size: 33vh;
      }

      .category {
        margin: 5vw 0;
      }

      .category__title {
        font-size: 3vw;
        text-transform: uppercase;
      }

      .category__input {
        width: 80vw;
        padding: 2vw 0;
        background-color: transparent;
        border: none;
        border-bottom: 1px solid var(--foreground);
        border-radius: 0;
        font-size: 7.5vw;
        font-weight: 900;
        color: var(--foreground);
        outline: none;
      }

      .category__input:focus {
        outline: 3px solid rgba(245, 223, 77, .5); /* --p-illuminating */
      }

      .stop {
        width: 100%;
        margin: 5vw 0;
        padding: 5vw 0;
        background-color: transparent;
        border: 1px solid var(--foreground);
        color: var(--foreground);
        font-size: 5vw;
        font-weight: 900;
        text-transform: uppercase;
      }
    </style>

    <script type="text/javascript">
      const $dom = {
        rouletteLetter: null,
      };

      const letterFrequencies = {};
      const modeClasses = {
        INPUT: 'body--mode-input',
        ROULETTE: 'body--mode-roulette',
      };

      const firebaseConfig = {
        apiKey: "AIzaSyB4w3C1DBUU-zQqq5EJ1AY0am0eJyT-8_k",
        authDomain: "basta-game.firebaseapp.com",
        databaseURL: "https://basta-game-default-rtdb.firebaseio.com",
        projectId: "basta-game",
        storageBucket: "basta-game.appspot.com",
        messagingSenderId: "423605935808",
        appId: "1:423605935808:web:54d13733fe1cc1b47e5725"
      };

      let rouletteIntervalId;
      let database;

      function setup () {
        firebase.initializeApp(firebaseConfig);
        database = firebase.database();

        // $dom hydration
        $dom.rouletteLetter = document.getElementById('roulette-letter');

        $dom.rouletteLetter.addEventListener('click', (event) => {
          stopRoulette();
          writeCurrentLetter();
        });

        // Firebase handlers
        const starCountRef = firebase.database().ref('currentLetter');

        starCountRef.on('value', (snapshot) => {
          onCurrentLetter(snapshot);
        });

        rouletteIntervalId = startRoulette();
      }

      function startRoulette() {
        return setInterval(() => {
          // Get a random number from 0 to 25
          const random = Math.floor(Math.random() * 26);
          // Get a letter from a (97) to z (122)
          const letter = String.fromCharCode(random + 97);

          if (!letterFrequencies[letter]) {
            letterFrequencies[letter] = 0;
          }

          letterFrequencies[letter]++;

          $dom.rouletteLetter.textContent = letter;
        }, 66); // ~15 fps
      }

      function stopRoulette() {
        setMode(modeClasses.INPUT);
        clearInterval(rouletteIntervalId);
      }

      function setMode(modeClass) {
        document.body.classList.remove(modeClasses.INPUT, modeClasses.ROULETTE);
        document.body.classList.add(modeClass);
      }

      function writeCurrentLetter() {
        // TODO: Add state
        database.ref('currentLetter').set($dom.rouletteLetter.textContent);
      }

      // TODO: Update state
      function updateCurrentLetter(currentLetter) {
        $dom.rouletteLetter.textContent = currentLetter;
      }

      function onCurrentLetter(snapshot) {
        const currentLetter = snapshot.val();

        if (!currentLetter) {
          return;
        }

        stopRoulette();
        updateCurrentLetter(currentLetter);
      }

      document.addEventListener('DOMContentLoaded', (event) => {
        setup();
      });
    </script>
  </head>

  <body
    class="body--mode-roulette"
  >
    <section
      class="roulette"
    >
      <div
        id="roulette-letter"
        class="roulette__letter"
      >
        Q
      </div>
    </section>

    <section>
      <div
        class="category"
      >
        <div
          class="category__title"
        >
          Nombre
        </div>

        <input
          type="text"
          class="category__input"
        >
      </div>

      <div
        class="category"
      >
        <div
          class="category__title"
        >
          País o ciudad
        </div>

        <input
          type="text"
          class="category__input"
        >
      </div>

      <div
        class="category"
      >
        <div
          class="category__title"
        >
          Animal
        </div>

        <input
          type="text"
          class="category__input"
        >
      </div>

      <div
        class="category"
      >
        <div
          class="category__title"
        >
          Flor o fruto
        </div>

        <input
          type="text"
          class="category__input"
        >
      </div>

      <div
        class="category"
      >
        <div
          class="category__title"
        >
          Color
        </div>

        <input
          type="text"
          class="category__input"
        >
      </div>

      <div
        class="category"
      >
        <div
          class="category__title"
        >
          Comida
        </div>

        <input
          type="text"
          class="category__input"
        >
      </div>

      <div
        class="category"
      >
        <div
          class="category__title"
        >
          Película o serie
        </div>

        <input
          type="text"
          class="category__input"
        >
      </div>

      <button
        class="stop"
      >
        ¡Basta!
      </button>
    </section>

    <script
      src="https://www.gstatic.com/firebasejs/8.2.4/firebase-app.js"
    ></script>

    <script
      src="https://www.gstatic.com/firebasejs/8.2.4/firebase-database.js"
    ></script>
  </body>
</html>
