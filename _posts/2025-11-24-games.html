---
permalink: /games/memory
---
<!DOCTYPE html>
<html
  lang="es-MX"
>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="title" content="Minigames üé≤">
    <meta name="description" content="Minigames üé≤">

    <title>Minigames üé≤  - eduardogarcia.xyz</title>

    <style type="text/css">
      :root {
        /* https://material.io/design/color/the-color-system.html#tools-for-picking-colors */
        --m-blue-900: #0d47a1;
        --m-yellow-600: #fdd835;

        --black: #000000;
        --white: #ffffff;

        /* https://colorhunt.co/palette/f2efe79acbd048a6a7006a71 */
        --beige: #F2EFE7;
        --light-teal: #9ACBD0;
        --teal: #48A6A7;
        --dark-teal: #006A71;
      }

      html {
        background-color: var(--dark-teal);
        font-size: 2.5vmin;
        hyphens: auto;
      }

      @media (width <= 1024px) {
        html {
          font-size: 1.75vmin;
        }
      }

      @media (orientation: portrait) {
        html {
          font-size: 1.25vmin;
        }
      }

      body {
        font-family: 'Helvetica Neue', Helvetica, sans-serif;
        margin: 0;
      }

      main {
        display: flex;
        flex: 1 0 auto;
        flex-direction: row;
        flex-wrap: wrap;
      }

      button {
        border: .5rem solid var(--beige);
        background-color: var(--beige);
        color: var(--dark-teal);
        cursor: pointer;
        font-weight: bold;
        font-size: 2.5rem;
        height: 25vh;
        height: 25dvh;
        text-align: center;
        vertical-align: middle;
        width: 20vw;
        width: 20dvw;
      }

      button:hover {
        border-color: var(--light-teal);
      }

      .selected {
        background-color: var(--light-teal);
        border-color: var(--light-teal);
      }

      .success {
        background-color: var(--dark-teal);
        border-color: var(--dark-teal);
        color: var(--light-teal);
        opacity: .25;
        pointer-events: none;
      }

      [data-type=emoji] {
        font-size: 5rem;
      }
    </style>
  </head>

  <body>
    <main></main>

    <script>
      // From:
      // * https://github.com/thewarpaint/caracteres/blob/master/assets/main.js.6c8d34e4d9f32beef481d506919d9d7004096bcd.js
      // * https://github.com/thewarpaint/caracteres/blob/master/_includes/early-scripts.html

      // TODO: Extract into URL helper
      const url = new URL(window.location.href);

      const defaultLanguages = ["es-MX", "es-ES", "es"]; // ["en-UK", "en-US", "en-GB", "en"]
      const urlLanguage = url.searchParams.get('lang');
      const defaultGame = 'animals';
      const urlGame = url.searchParams.get('game');

      const Globals = {
        languages: urlLanguage === null ? defaultLanguages : [urlLanguage],
      };

      const mammals = [
        {
          cardId: 'bat',
          emoji: 'ü¶á',
          i18n: {
            en: 'bat',
            es: 'murci√©lago',
          },
        },
        {
          cardId: 'bear',
          emoji: 'üêª',
          i18n: {
            en: 'bear',
            es: 'oso',
          },
        },
        {
          cardId: 'bison',
          emoji: 'ü¶¨',
          i18n: {
            en: 'bison',
            es: 'b√∫falo',
          },
        },
        {
          cardId: 'boar',
          emoji: 'üêó',
          i18n: {
            en: 'boar',
            es: 'jabal√≠',
          },
        },
        {
          cardId: 'bunny',
          emoji: 'üê∞',
          i18n: {
            en: 'bunny',
            es: 'conejo',
          },
        },
        {
          cardId: 'cat',
          emoji: 'üê±',
          i18n: {
            en: 'cat',
            es: 'gato',
          },
        },
        {
          cardId: 'camel',
          emoji: 'üê™',
          i18n: {
            en: 'camel',
            es: 'camello',
          },
        },
        {
          cardId: 'cow',
          emoji: 'üêÆ',
          i18n: {
            en: 'cow',
            es: 'vaca',
          },
        },
        {
          cardId: 'deer',
          emoji: 'ü¶å',
          i18n: {
            en: 'deer',
            es: 'reno',
          },
        },
        {
          cardId: 'dog',
          emoji: 'üê∂',
          i18n: {
            en: 'dog',
            es: 'perro',
          },
        },
        {
          cardId: 'elephant',
          emoji: 'üêò',
          i18n: {
            en: 'elephant',
            es: 'elefante',
          },
        },
        {
          cardId: 'fox',
          emoji: 'ü¶ä',
          i18n: {
            en: 'fox',
            es: 'zorro',
          },
        },
        {
          cardId: 'giraffe',
          emoji: 'ü¶í',
          i18n: {
            en: 'giraffe',
            es: 'jirafa',
          },
        },
        {
          cardId: 'gorilla',
          emoji: 'ü¶ç',
          i18n: {
            en: 'gorilla',
            es: 'gorila',
          },
        },
        {
          cardId: 'hedgehog',
          emoji: 'ü¶î',
          i18n: {
            en: 'hedgehog',
            es: 'puerco esp√≠n',
          },
        },
        {
          cardId: 'hippopotamus',
          emoji: 'ü¶õ',
          i18n: {
            en: 'hippopotamus',
            es: 'hipop√≥tamo',
          },
        },
        {
          cardId: 'horse',
          emoji: 'üê¥',
          i18n: {
            en: 'horse',
            es: 'caballo',
          },
        },
        {
          cardId: 'kangaroo',
          emoji: 'ü¶ò',
          i18n: {
            en: 'kangaroo',
            es: 'canguro',
          },
        },
        {
          cardId: 'koala',
          emoji: 'üê®',
          i18n: {
            en: 'koala',
            es: 'koala',
          },
        },
        {
          cardId: 'llama',
          emoji: 'ü¶ô',
          i18n: {
            en: 'llama',
            es: 'llama',
          },
        },
        {
          cardId: 'leopard',
          emoji: 'üêÜ',
          i18n: {
            en: 'leopard',
            es: 'leopardo',
          },
        },
        {
          cardId: 'lion',
          emoji: 'ü¶Å',
          i18n: {
            en: 'lion',
            es: 'le√≥n',
          },
        },
        {
          cardId: 'monkey',
          emoji: 'üêµ',
          i18n: {
            en: 'monkey',
            es: 'mono',
          },
        },
        {
          cardId: 'mouse',
          emoji: 'üê≠',
          i18n: {
            en: 'mouse',
            es: 'rat√≥n',
          },
        },
        {
          cardId: 'orangutan',
          emoji: 'ü¶ß',
          i18n: {
            en: 'orangutan',
            es: 'orangut√°n',
          },
        },
        {
          cardId: 'panda',
          emoji: 'üêº',
          i18n: {
            en: 'panda',
            es: 'panda',
          },
        },
        {
          cardId: 'pig',
          emoji: 'üê∑',
          i18n: {
            en: 'pig',
            es: 'cerdo',
          },
        },
        {
          cardId: 'polar-bear',
          emoji: 'üêª‚Äç‚ùÑÔ∏è',
          i18n: {
            en: 'polar bear',
            es: 'oso polar',
          },
        },
        {
          cardId: 'raccoon',
          emoji: 'ü¶ù',
          i18n: {
            en: 'raccoon',
            es: 'mapache',
          },
        },
        {
          cardId: 'rhinoceros',
          emoji: 'ü¶è',
          i18n: {
            en: 'rhinoceros',
            es: 'rinoceronte',
          },
        },
        {
          cardId: 'skunk',
          emoji: 'ü¶®',
          i18n: {
            en: 'skunk',
            es: 'zorrillo',
          },
        },
        {
          cardId: 'sloth',
          emoji: 'ü¶•',
          i18n: {
            en: 'sloth',
            es: 'perezoso',
          },
        },
        {
          cardId: 'squirrel',
          emoji: 'üêøÔ∏è',
          i18n: {
            en: 'squirrel',
            es: 'ardilla',
          },
        },
        {
          cardId: 'tiger',
          emoji: 'üêØ',
          i18n: {
            en: 'tiger',
            es: 'tigre',
          },
        },
        {
          cardId: 'wolf',
          emoji: 'üê∫',
          i18n: {
            en: 'wolf',
            es: 'lobo',
          },
        },
        {
          cardId: 'whale',
          emoji: 'üê≥',
          i18n: {
            en: 'whale',
            es: 'ballena',
          },
        },
        {
          cardId: 'zebra',
          emoji: 'ü¶ì',
          i18n: {
            en: 'zebra',
            es: 'cebra',
          },
        },
      ];

      const animals = [
        ...mammals,
        {
          cardId: 'chicken',
          emoji: 'üê§',
          i18n: {
            en: 'chicken',
            es: 'pollo',
          },
        },
        {
          cardId: 'hen',
          emoji: 'üêî',
          i18n: {
            en: 'hen',
            es: 'gallina',
          },
        },
        {
          cardId: 'frog',
          emoji: 'üê∏',
          i18n: {
            en: 'frog',
            es: 'rana',
          },
        },
        {
          cardId: 'turtle',
          emoji: 'üê¢',
          i18n: {
            en: 'turtle',
            es: 'tortuga',
          },
        },
        {
          cardId: 'crocodile',
          emoji: 'üêä',
          i18n: {
            en: 'crocodile',
            es: 'cocodrilo',
          },
        },
        {
          cardId: 'snail',
          emoji: 'üêå',
          i18n: {
            en: 'snail',
            es: 'caracol',
          },
        },

        {
          cardId: 'spider',
          emoji: 'üï∑Ô∏è',
          i18n: {
            en: 'spider',
            es: 'ara√±a',
          },
        },
        {
          cardId: 't-rex',
          emoji: 'ü¶ñ',
          i18n: {
            en: 't-rex',
            es: 't rex',
          },
        },
        {
          cardId: 'unicorn',
          emoji: 'ü¶Ñ',
          i18n: {
            en: 'unicorn',
            es: 'unicornio',
          },
        },
        {
          cardId: 'duck',
          emoji: 'ü¶Ü',
          i18n: {
            en: 'duck',
            es: 'pato',
          },
        },
        {
          cardId: 'shark',
          emoji: 'ü¶à',
          i18n: {
            en: 'shark',
            es: 'tibur√≥n',
          },
        },
        {
          cardId: 'butterfly',
          emoji: 'ü¶ã',
          i18n: {
            en: 'butterfly',
            es: 'mariposa',
          },
        },
        {
          cardId: 'fish',
          emoji: 'üê†',
          i18n: {
            en: 'fish',
            es: 'pez',
          },
        },
        {
          cardId: 'blowfish',
          emoji: 'üê°',
          i18n: {
            en: 'blowfish',
            es: 'pez globo',
          },
        },
        {
          cardId: 'bee',
          emoji: 'üêù',
          i18n: {
            en: 'bee',
            es: 'abeja',
          },
        },
        {
          cardId: 'snake',
          emoji: 'üêç',
          i18n: {
            en: 'snake',
            es: 'v√≠bora',
          },
        },
      ];

      const fruitsAndVeggies = [
        {
          cardId: 'tomato',
          emoji: 'üçÖ',
          i18n: {
            en: 'tomato',
            es: 'jitomate',
          },
        },
        {
          cardId: 'apple',
          emoji: 'üçé',
          i18n: {
            en: 'apple',
            es: 'manzana',
          },
        },
        {
          cardId: 'banana',
          emoji: 'üçå',
          i18n: {
            en: 'banana',
            es: 'banana',
          },
        },
        {
          cardId: 'carrot',
          emoji: 'ü•ï',
          i18n: {
            en: 'carrot',
            es: 'zanahoria',
          },
        },
        {
          cardId: 'mango',
          emoji: 'ü•≠',
          i18n: {
            en: 'mango',
            es: 'mango',
          },
        },
        {
          cardId: 'strawberry',
          emoji: 'üçì',
          i18n: {
            en: 'strawberry',
            es: 'fresa',
          },
        },
        {
          cardId: 'potato',
          emoji: 'ü•î',
          i18n: {
            en: 'potato',
            es: 'papa',
          },
        },
        {
          cardId: 'blueberry',
          emoji: 'ü´ê',
          i18n: {
            en: 'blueberry',
            es: 'mora azul',
          },
        },
        {
          cardId: 'corn',
          emoji: 'üåΩ',
          i18n: {
            en: 'corn',
            es: 'elote',
          },
        },
        {
          cardId: 'orange',
          emoji: 'üçä',
          i18n: {
            en: 'orange',
            es: 'naranja',
          },
        },
      ];

      const bodyParts = [
        {
          cardId: 'arm',
          emoji: 'üí™',
          i18n: {
            en: 'arm',
            es: 'brazo',
          },
        },
        {
          cardId: 'leg',
          emoji: 'ü¶µ',
          i18n: {
            en: 'leg',
            es: 'pierna',
          },
        },
        {
          cardId: 'foot',
          emoji: 'ü¶∂',
          i18n: {
            en: 'foot',
            es: 'pie',
          },
        },
        {
          cardId: 'ear',
          emoji: 'üëÇ',
          i18n: {
            en: 'ear',
            es: 'o√≠do',
          },
        },
        {
          cardId: 'nose',
          emoji: 'üëÉ',
          i18n: {
            en: 'nose',
            es: 'nariz',
          },
        },
        {
          cardId: 'tooth',
          emoji: 'ü¶∑',
          i18n: {
            en: 'tooth',
            es: 'diente',
          },
        },
        {
          cardId: 'eye',
          emoji: 'üëÅÔ∏è',
          i18n: {
            en: 'eye',
            es: 'ojo',
          },
        },
        {
          cardId: 'tongue',
          emoji: 'üëÖ',
          i18n: {
            en: 'tongue',
            es: 'lengua',
          },
        },
        {
          cardId: 'hand',
          emoji: 'üñêÔ∏è',
          i18n: {
            en: 'hand',
            es: 'mano',
          },
        },
        {
          cardId: 'nails',
          emoji: 'üíÖ',
          i18n: {
            en: 'nails',
            es: 'u√±as',
          },
        },
        {
          cardId: 'finger',
          emoji: '‚òùÔ∏è',
          i18n: {
            en: 'finger',
            es: 'dedo',
          },
        },
        {
          cardId: 'thumb',
          emoji: 'üëç',
          i18n: {
            en: 'thumb',
            es: 'pulgar',
          },
        },
        {
          cardId: 'fist',
          emoji: 'üëä',
          i18n: {
            en: 'fist',
            es: 'pu√±o',
          },
        },
      ];

      const faces = [
        {
          cardId: 'happy',
          emoji: 'üòÄ',
          i18n: {
            en: 'happy',
            es: 'feliz',
          },
        },
        {
          cardId: 'sad',
          emoji: '‚òπÔ∏è',
          i18n: {
            en: 'sad',
            es: 'triste',
          },
        },
        {
          cardId: 'angry',
          emoji: 'üò†',
          i18n: {
            en: 'angry',
            es: 'enojado',
          },
        },

        {
          cardId: 'crying',
          emoji: 'üò≠',
          i18n: {
            en: 'crying',
            es: 'llorando',
          },
        },
        {
          cardId: 'kiss',
          emoji: 'üòò',
          i18n: {
            en: 'kiss',
            es: 'beso',
          },
        },
        {
          cardId: 'sleeping',
          emoji: 'üò¥',
          i18n: {
            en: 'sleeping',
            es: 'durmiendo',
          },
        },
        {
          cardId: 'sneezing',
          emoji: 'ü§ß',
          i18n: {
            en: 'sneezing',
            es: 'estornudo',
          },
        },
        {
          cardId: 'sick',
          emoji: 'ü§í',
          i18n: {
            en: 'sick',
            es: 'enfermo',
          },
        },
        {
          cardId: 'afraid',
          emoji: 'üò®',
          i18n: {
            en: 'afraid',
            es: 'miedo',
          },
        },
        {
          cardId: 'dizzy',
          emoji: 'üòµ‚Äçüí´',
          i18n: {
            en: 'dizzy',
            es: 'mareado',
          },
        },
      ];

      const numbers = [
        {
          cardId: 'zero',
          emoji: '0Ô∏è‚É£',
          i18n: {
            en: 'zero',
            es: 'cero',
          },
        },
        {
          cardId: 'one',
          emoji: '1Ô∏è‚É£',
          i18n: {
            en: 'one',
            es: 'uno',
          },
        },
        {
          cardId: 'two',
          emoji: '2Ô∏è‚É£',
          i18n: {
            en: 'two',
            es: 'dos',
          },
        },
        {
          cardId: 'three',
          emoji: '3Ô∏è‚É£',
          i18n: {
            en: 'three',
            es: 'tres',
          },
        },
        {
          cardId: 'four',
          emoji: '4Ô∏è‚É£',
          i18n: {
            en: 'four',
            es: 'cuatro',
          },
        },
        {
          cardId: 'five',
          emoji: '5Ô∏è‚É£',
          i18n: {
            en: 'five',
            es: 'cinco',
          },
        },
        {
          cardId: 'six',
          emoji: '6Ô∏è‚É£',
          i18n: {
            en: 'six',
            es: 'seis',
          },
        },
        {
          cardId: 'seven',
          emoji: '7Ô∏è‚É£',
          i18n: {
            en: 'seven',
            es: 'siete',
          },
        },
        {
          cardId: 'eight',
          emoji: '8Ô∏è‚É£',
          i18n: {
            en: 'eight',
            es: 'ocho',
          },
        },
        {
          cardId: 'nine',
          emoji: '9Ô∏è‚É£',
          i18n: {
            en: 'nine',
            es: 'nueve',
          },
        },
        {
          cardId: 'ten',
          emoji: 'üîü',
          i18n: {
            en: 'ten',
            es: 'diez',
          },
        },
      ];

      const games = {
        animals,
        mammals,
        bodyParts,
        faces,
        fruitsAndVeggies,
        numbers,
      };

      const cards = urlGame === null ? games[defaultGame] : games[urlGame];

      document.addEventListener('DOMContentLoaded', function (event) {
        FeatureDetection.init();
        Games.init();
      });

      // TODO: Refactor to proper class
      const FeatureDetection = (function () {
        function FeatureDetection() {}

        FeatureDetection.prototype.hasSpeechSynthesis = function () {
          return 'speechSynthesis' in window;
        };

        FeatureDetection.prototype.hasLocalStorage = function () {
          // From https://github.com/Modernizr/Modernizr/blob/master/feature-detects/storage/localstorage.js#L40
          var mod = 'modernizr';

          try {
            localStorage.setItem(mod, mod);
            localStorage.removeItem(mod);
            return true;
          } catch (e) {
            return false;
          }
        };

        FeatureDetection.prototype.init = function () {
          var features = [
            {
              detector: this.hasSpeechSynthesis,
              aClass: 'body--has-speech-synthesis'
            },
            {
              detector: this.hasLocalStorage,
              aClass: 'body--has-local-storage'
            }
          ];

          // TODO: Refactor to use `classList`
          var bodyClasses = [];

          for(var i = 0; i < features.length; i++) {
            if (features[i].detector()) {
              bodyClasses.push(features[i].aClass);
            }
          }

          document.body.className += ' ' + bodyClasses.join(' ');
        };

        return new FeatureDetection();
      })();

      // TODO: Refactor to proper class
      const Console = (function () {
        function Console() {
          this.element = document.querySelector('.console');
        }

        Console.prototype.log = function log(string) {
          console.log(string);

          if (this.element) {
            this.element.innerHTML += '\n‚áí ' + string;
          }
        };

        return new Console();
      })();

      // TODO: Refactor to proper class
      const Synth = (function () {
        function Synth() {
          this.voices = {};
          this.onVoicesChangedCallback = function () {}; // noop
        }

        Synth.prototype.init = function (onVoicesChangedCallback) {
          if (FeatureDetection.hasSpeechSynthesis()) {
            if (typeof speechSynthesis.onvoiceschanged !== 'undefined') {
              speechSynthesis.onvoiceschanged = this.onVoicesChanged;
            }

            if (typeof onVoicesChangedCallback === 'function') {
              this.onVoicesChangedCallback = onVoicesChangedCallback;
            }

            this.onVoicesChanged();
          }
        };

        Synth.prototype.onVoicesChanged = function () {
          speechSynthesis.getVoices().forEach(function (voice) {
            var normalizedLanguageId = voice.lang.replace(/_/g, '-');

            if (!window.Synth.voices[normalizedLanguageId]) {
              Console.log('Adding voice for language ' + normalizedLanguageId + '.');
              window.Synth.voices[normalizedLanguageId] = voice;
            }
          });

          window.Synth.onVoicesChangedCallback();
        };

        Synth.prototype.speakInLanguageIds = function (word, languageIds) {
          for (var i = 0; i < languageIds.length; i++) {
            if (window.Synth.voices[languageIds[i]]) {
              this.speak(word, this.voices[languageIds[i]]);

              return;
            }
          }

          Console.log('No voice available for languages: ' + languageIds.join(',') + '.');
        };

        Synth.prototype.speakInLanguageId = function (word, languageId) {
          if (!this.voices[languageId]) {
            Console.log('No voice available for language: ' + languageId + '.');
            return;
          }

          this.speak(word, this.voices[languageId]);
        };

        Synth.prototype.speak = function (word, voice) {
          Console.log('Speaking "' + word + '" in ' + voice.lang + '.');

          var utterance;

          if (!window.myUtterances) {
            window.myUtterances = {};
          }

          if (window.myUtterances[word]) {
            utterance = window.myUtterances[word];
          } else {
            utterance = new SpeechSynthesisUtterance(word);
            utterance.voice = voice;
            utterance.lang = voice.lang;
            window.myUtterances[word] = utterance;
          }

          speechSynthesis.speak(utterance);
        };

        return new Synth();
      })();

      const Games = (function () {
        function Games() {
          this.hasMainLanguageVoice = false;
          this.showNerdStuffBtn = null;
          // { id, type, animal }
          this.state = {
            activeCard: null,
          };
          // TODO: Extract into lang utils
          // Default values, will be updated later if needed
          this.mainLanguage = Globals.languages[0];
          this.mainBaseLanguage = this.mainLanguage.split('-')[0];
          this.maxCards = 10;
        }

        Games.prototype.init = function () {
          Console.log('Version: ' + Globals.version);

          Synth.init(this.onVoicesChanged);

          let innerHtml = '';

          shuffleArray(cards);
          const selectedCards = cards.slice(0, window.Games.maxCards);
          let cardsShuffled = Array.from(selectedCards);
          const baseLanguage = window.Games.mainBaseLanguage;
          shuffleArray(cardsShuffled);

          const emojiCardsHtmls = cardsShuffled
            .map((card) =>
              window.Games.getCardInnerHtml(card, 'emoji', baseLanguage)
            );

          shuffleArray(cardsShuffled);

          const wordCardsHtmls = cardsShuffled
            .map((card) =>
              window.Games.getCardInnerHtml(card, 'word', baseLanguage)
            );

          const emojiFirst = Math.random() > 0.5;

          for (let i = 0; i < cardsShuffled.length; i++) {
            if (emojiFirst) {
              innerHtml += emojiCardsHtmls[i];
              innerHtml += wordCardsHtmls[i];
            } else {
              innerHtml += wordCardsHtmls[i];
              innerHtml += emojiCardsHtmls[i];
            }
          }

          document.querySelector('main').innerHTML = document.querySelector('main').innerHTML + innerHtml;

          if (FeatureDetection.hasSpeechSynthesis()) {
            this.addSpeakButtonClickListeners();
          }

          // this.showNerdStuffBtn = document.getElementById('show-nerd-stuff-btn');
          // this.showNerdStuffBtn.addEventListener('click', window.Chocolate.onShowNerdStuffClick.bind(this));
        };

        Games.prototype.onVoicesChanged = function () {
          for (var i = 0; i < Globals.languages.length; i++) {
            window.Games.hasMainLanguageVoice =
              typeof window.Synth.voices[Globals.languages[i]] !== 'undefined';

            if (window.Games.hasMainLanguageVoice) {
              Console.log('Selecting voice for language ' + Globals.languages[i] + '.');
              window.Games.mainLanguage = Globals.languages[i];
              window.Games.mainBaseLanguage = window.Games.mainLanguage.split('-')[0];
              document.body.classList.add('body--has-voice-available');

              break;
            }
          }

          if (!window.Games.hasMainLanguageVoice) {
            Console.log('No voice available for languages: ' + Globals.languages.join(',') + '.');
          }
        };

        Games.prototype.speak = function (word) {
          window.Synth.speakInLanguageId(word, window.Games.mainLanguage);
        };

        Games.prototype.onCardClick = function (e) {
          window.Games.speak(this.getAttribute('data-speak'));

          const cardElement = e.target;

          const clickedCard = {
            id: cardElement.id,
            type: cardElement.dataset.type,
            animal: cardElement.dataset.animal,
          };

          window.Games.state = window.Games.applyNextState(window.Games.state, clickedCard);
        };


        Games.prototype.applyNextState = function (oldState, clickedCard) {
          // State transitions (state + event => new state):
          // * start + first click => selected
          // * start + second click, unrelated => start
          // * start + second click, same card => start
          // * start + second click, match => success
          // * selected + second click, unrelated => start
          // * selected + second click, match => success

          const $clickedCard = document.getElementById(clickedCard.id);
          const initialState = {
            activeCard: null,
          };
          let newState = {};

          // TODO: Refactor classList updates into a returned closure to be executed by caller
          if (oldState.activeCard === null) {
            // First click
            // Transition: start + first click => selected
            $clickedCard.classList.add('selected');

            newState = {
              activeCard: clickedCard,
            };
          } else {
            // Second click
            const isSameCard = oldState.activeCard.id === clickedCard.id;
            const isMatch = oldState.activeCard.animal === clickedCard.animal;
            const $activeCard = document.getElementById(oldState.activeCard.id);

            if (isSameCard) {
              // Transition:  start + second click, same card => start
              $activeCard.classList.remove('selected');

              newState = initialState;
            } else if (isMatch) {
              // Transition: selected + second click, match => success
              $activeCard.classList.remove('selected');
              $activeCard.classList.add('success');

              // Transition: start + second click, match => success
              $clickedCard.classList.add('success');

              newState = initialState;
            } else {
              // Transition: start + second click, unrelated => start (no-op)
              // Transition: selected + second click, unrelated => start
              $activeCard.classList.remove('selected');

              newState = initialState;
            }
          }

          return newState;
        };

        Games.prototype.getCardInnerHtml = function (cardData, type, language) {
          const {cardId, emoji} = cardData;
          const speakText = cardData.i18n[language];
          const buttonText = type === 'emoji' ? emoji : speakText;

          return `
            <button
              id="button-${type}-${cardId}"
              data-type="${type}"
              data-animal="${cardId}"
              data-speak="${speakText}"
            >
              ${buttonText}
            </button>
          `;
        };

        Games.prototype.onListenableLinkClick = function () {
          if (this.getAttribute('data-lang')) {
            var languageIds = this.getAttribute('data-lang').split(',');
            window.Synth.speakInLanguageIds(this.innerText, languageIds);
          } else {
            window.Games.speak(this.innerText);
          }
        };

        Games.prototype.addSpeakButtonClickListeners = function () {
          Array.prototype.slice.apply(document.querySelectorAll('[data-speak]'))
            .forEach(function (button) {
              button.addEventListener('click', window.Games.onCardClick);
            });
        };

        Games.prototype.onShowNerdStuffClick = function () {
          document.getElementById('console').classList.remove('console--hidden');
          this.showNerdStuffBtn.classList.add('btn--hidden');
        };

        return new Games();
      })();

      // Randomize array in-place using Durstenfeld shuffle algorithm
      // https://stackoverflow.com/a/12646864
      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
      }

      window.Games = Games;
      window.Synth = Synth;
    </script>
  </body>
</html>