---
permalink: /tacokeeper
---
{%- assign options = site.data.tacokeeper.options -%}
{%- assign postTitle = "TacoKeeper" -%}
{%- assign postDescription = "Monitorea tus actividades gastronómicas" -%}
<!DOCTYPE html>
<html lang="es-MX">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="{{ postTitle }}">
    <meta name="description" content="{{ postDescription }}">

    <title>{{ postTitle }}</title>

    <style type="text/css">
      /* Material UI palettes: https://material.io/design/color/the-color-system.html#tools-for-picking-colors */

      html {
        font-family: "Helvetica Neue", Helvetica, sans-serif;
        font-size: 16px;
      }

      body {
        margin: 0;
      }

      @media(min-width: 480px) {
        body {
          max-width: 448px; /* 480px - (2 * 16px) */
          margin-left: auto;
          margin-right: auto;
        }
      }

      /* Search */
      .search {
        position: -webkit-sticky;
        position: sticky;
        top: 0;
        background-color: white;
        border-bottom: 1px solid #b0bec5; /* Blue Gray 200 */
        margin-bottom: 1rem;
      }

      .search__input {
        width: 100%;
        padding: 1rem;
        border: none;
        color: #78909c; /* Blue Gray 400 */
        background-color: transparent;
        font-size: 1.5rem;
      }

      .search__input::placeholder {
        color: #b0bec5; /* Blue Gray 200 */
      }

      /* Capture area */
      .input {
        width: 2rem;
        border: none;
        border-bottom: 1px solid #b0bec5; /* Blue Gray 200 */
        color: #b0bec5; /* Blue Gray 200 */
        background-color: transparent;
        font-size: 1.5rem;
        text-align: center;
        transition-duration: .25s;
        transition-timing-function: linear;
        transition-property: color, border;
      }

      .input::-webkit-input-placeholder {
        color: #b0bec5; /* Blue Gray 200 */
      }

      .input::-moz-placeholder {
        color: #b0bec5; /* Blue Gray 200 */
      }

      .input::placeholder {
        color: #b0bec5; /* Blue Gray 200 */
      }

      .input:focus {
        border-bottom-color: #78909c; /* Blue Gray 400 */
        color: #78909c; /* Blue Gray 400 */
      }

      .option--active .input {
        border-bottom-color: #f57f17; /* Yellow 900 */
        color: #f57f17; /* Yellow 900 */
      }

      .input::-webkit-inner-spin-button,
      .input::-webkit-outer-spin-button {
        -webkit-appearance: none;
        appearance: none;
        margin: 0;
      }

      .options {
        list-style: none;
        padding-left: 0;
        margin: 0;
      }

      .option {
        margin: 0;
        padding: 1rem;
        transition: .25s linear background;
      }

      .option--active {
        background-color: #fff9c4; /* Yellow 100 */
      }

      .option--hidden {
        display: none;
      }

      .option__name {
        margin-left: .25rem;
        font-size: 1.5rem;
        color: #b0bec5; /* Blue Gray 200 */
        transition: .25s linear color;
      }

      .input:focus + .option__name {
        color: #78909c; /* Blue Gray 400 */
      }

      .option--active .option__name,
      .option--active .input:focus + .option__name {
        color: #f57f17; /* Yellow 900 */
      }

      .tweet-text {
        margin: 2rem 1rem 1rem;
        font-size: 1.5rem;
      }

      .tweet-link {
        display: block;
        position: -webkit-sticky;
        position: sticky;
        bottom: 0;
        margin-top: 1.5rem;
        padding: 1rem .75rem;
        color: white;
        background-color: #1da1f2; /* Twitter blue */
        font-size: 1.375rem;
        font-weight: bold;
        text-align: center;
        text-decoration: none;
        text-transform: uppercase;
        letter-spacing: .0625rem;
      }

      /* Statistics */
      .top-option {
        display: flex;
        align-items: center;
        color: white;
        background-color: black;
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
        padding: 2rem 0;
      }

      .top-option--CAM {
        background-image: url('https://i.imgur.com/Z1uQfGT.jpg');
      }

      .top-option--PAS {
        background-image: url('https://i.imgur.com/nRPSadi.jpg');
      }

      .top-option--SUR {
        background-image: url('https://i.imgur.com/IuVSoqh.jpg');
      }

      .top-option__place,
      .top-option__record {
        text-shadow: 1px 1px 0 black;
      }

      .top-option__place {
        flex: 0 0 auto;
        margin: 1rem 0;
        padding: 0 2.5rem;
        text-align: right;
        font-size: 2.5rem;
        font-weight: bold;
      }

      .top-option__record {
        padding-right: 1.5rem;
        font-size: 1.75rem;
      }

      .top-option__quantity {
        font-weight: bold;
      }

      .statistics__header,
      .statistics__paragraph {
        margin: 1rem;
      }

      .statistics__paragraph {
        font-size: 1.25rem;
      }

      .statistics__user {
        color: #1da1f2; /* Twitter blue */
        font-weight: bold;
      }

      .statistics__number {
        font-weight: bold;
      }
    </style>

    <script type="text/javascript">
      var $tweetLink;
      var $tweetText;
      var $searchInput;
      var optionsArray = {{ options | jsonify }};
      var optionsMap = getOptionsMap(optionsArray);
      var model = {};
      var twitterIntentUrl = 'https://twitter.com/intent/tweet?';
      var targetUrl = 'https://eduardogarcia.xyz/tacokeeper';

      document.addEventListener('DOMContentLoaded', function (event) {
        $tweetLink = document.getElementById('tweet-link');
        $tweetText = document.getElementById('tweet-text');
        $searchInput = document.getElementById('search-input');

        addInputListeners(document.querySelectorAll('.option__input'));
        addElementsToOptions();

        $searchInput.addEventListener('input', function () {
          updateOptionsFromSearch(this.value.toLowerCase());
        });
      });

      function addInputListeners(inputs) {
        for (var i = 0; i < inputs.length; i++) {
          inputs[i].addEventListener('input', function (event) {
            var value = parseInt(this.value, 10);

            if (isNaN(value)) {
              value = 0;
            }

            model[this.name.replace('input-', '')] = value;
            updateTweet();
            updateActiveOptions();
          });
        }
      }

      function updateTweet() {
        var tweetText = 'Hoy comí ';
        var tweetHref = '';

        tweetText += getActiveModelKeys()
          .map(function (key) {
            return model[key].toString() +
              (model[key] === 1
                ? ' taco ' + optionsMap[key].forms.singular
                : ' tacos ' + optionsMap[key].forms.plural);
          })
          .join(', ');

        tweetHref = tweetText + ' #tacokeeper ' +
          targetUrl + '?t=' +
          getActiveModelKeys()
            .map(function (key) {
              return key + zeroPad(model[key]);
            })
            .join('');

        $tweetText.innerText = tweetText;
        $tweetLink.href = twitterIntentUrl +
          'text=' + encodeURIComponent(tweetHref);
      }

      // TODO: Update one option at a time
      function updateActiveOptions() {
        Object.keys(model)
          .forEach(function (key) {
            var $option = document.getElementById('option-' + key);

            if (model[key] > 0) {
              $option.classList.add('option--active');
            } else {
              $option.classList.remove('option--active');
            }
          });
      }

      function addElementsToOptions() {
        optionsArray.forEach(function (option) {
          option.$element = document.getElementById('option-' + option.key);
        });
      }

      function updateOptionsFromSearch(search) {
        optionsArray.forEach(function (option) {
          option.$element.classList.toggle('option--hidden', option.name.indexOf(search) === -1);
        });
      }

      function getOptionsMap(optionsArray) {
        var optionsMap = {};

        optionsArray
          .forEach(function (option) {
            optionsMap[option.key] = option;
          });

        return optionsMap;
      }

      function getActiveModelKeys() {
        return Object.keys(model)
          .filter(function (key) {
            return model[key] > 0;
          });
      }

      function zeroPad(number) {
        if (number <= 9) {
          return '0' + number.toString();
        }

        return number.toString();
      }
    </script>
  </head>

  <body>
    <section>
      <div class="search">
        <input type="search"
               id="search-input"
               class="search__input"
               name="search"
               placeholder="Busca tu taco">
      </div>

      <ul class="options">
        {%- for option in options -%}
        <li class="option"
            id="option-{{ option.key }}">
          <input type="number"
                 class="input option__input"
                 id="input-{{ option.key }}"
                 name="input-{{ option.key }}"
                 value=""
                 min="0"
                 max="99"
                 placeholder="?">
          <label for="input-{{ option.key }}"
                 class="option__name">× {{ option.name }}</label>
        </li>
        {%- endfor -%}
      </ul>

      <div id="tweet-text"
           class="tweet-text"></div>

      <a href="https://twitter.com/intent/tweet"
         class="tweet-link"
         id="tweet-link"
         target="_blank">Comparte en Twitter</a>
    </section>

    <section class="statistics">
      <h1 class="statistics__header">
        2019 en tacos
      </h1>

      <p class="statistics__paragraph">
        ¡Felicidades <span class="statistics__user">@tacokeeper</span>,
        en 2019 comiste <span class="statistics__number">432&nbsp;tacos</span>!
      </p>

      <div class="top">
        <div class="top-option top-option--1 top-option--CAM">
          <div class="top-option__place">
            #1
          </div>

          <div class="top-option__record">
            <span class="top-option__quantity">321</span> tacos<br>
            campechanos
          </div>
        </div>

        <div class="top-option top-option--2 top-option--PAS">
          <div class="top-option__place">
            #2
          </div>

          <div class="top-option__record">
            <span class="top-option__quantity">234</span> tacos<br>
            al pastor
          </div>
        </div>

        <div class="top-option top-option--3 top-option--SUR">
          <div class="top-option__place">
            #3
          </div>

          <div class="top-option__record">
            <span class="top-option__quantity">198</span> tacos<br>
            de surtida
          </div>
        </div>
      </div>

      <p class="statistics__paragraph">
        Comiste tacos en <span class="statistics__number">123&nbsp;días</span> de 365 en el año.
      </p>

      <p class="statistics__paragraph">
        Tu récord fue de <span class="statistics__number">25&nbsp;tacos</span> el 21 de marzo.
      </p>

      <p class="statistics__paragraph">
        Tu racha más larga fue de <span class="statistics__number">5&nbsp;días consecutivos</span> comiendo tacos.
      </p>
    </section>
  </body>
</html>
