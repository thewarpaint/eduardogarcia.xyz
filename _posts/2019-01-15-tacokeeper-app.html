---
permalink: /tacokeeper
---
{%- assign options = site.data.tacokeeper.options -%}
{%- assign postTitle = "TacoKeeper" -%}
{%- assign postDescription = "Monitorea tus actividades gastronómicas" -%}
<!DOCTYPE html>
<html lang="es-MX">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="{{ postTitle }}">
    <meta name="description" content="{{ postDescription }}">

    <title>{{ postTitle }}</title>

    <style type="text/css">
      h2 {
        display: inline;
      }
    </style>

    <script type="text/javascript">
      var $tweetLink;
      var $tweetText;
      var optionsArray = {{ options | jsonify }};
      var optionsMap = getOptionsMap(optionsArray);
      var model = {};
      var twitterIntentUrl = 'https://twitter.com/intent/tweet?';
      var targetUrl = 'https://eduardogarcia.xyz/tacokeeper';

      document.addEventListener('DOMContentLoaded', function (event) {
        $tweetLink = document.getElementById('tweet');
        $tweetText = document.getElementById('text');

        var inputs = document.querySelectorAll('input');

        for (var i = 0; i < inputs.length; i++) {
          inputs[i].addEventListener('input', function (event) {
            var value = parseInt(this.value, 10);

            if (isNaN(value)) {
              value = 0;
            }

            model[this.name.replace('input-', '')] = value;
            updateTweet();
          });
        }
      });

      function updateTweet() {
        var modelKeys = Object.keys(model);
        var tweetText = 'Hoy comí ';
        var tweetHref = '';

        tweetText += modelKeys
          .filter(function (key) {
            return model[key] > 0;
          })
          .map(function (key) {
            return model[key].toString() +
              (model[key] === 1
                ? ' taco ' + optionsMap[key].forms.singular
                : ' tacos ' + optionsMap[key].forms.plural);
          })
          .join(', ');

        tweetHref = tweetText + ' #tacokeeper ' +
          targetUrl + '?t=' +
          modelKeys
            .filter(function (key) {
              return model[key] > 0;
            })
            .map(function (key) {
              return key + zeroPad(model[key]);
            })
            .join('');

        $tweetText.innerText = tweetText;
        $tweetLink.href = twitterIntentUrl +
          'text=' + encodeURIComponent(tweetHref);
      }

      function getOptionsMap(optionsArray) {
        var optionsMap = {};

        optionsArray
          .forEach(function (option) {
            optionsMap[option.key] = option;
          });

        return optionsMap;
      }

      function zeroPad(number) {
        if (number <= 9) {
          return '0' + number.toString();
        }

        return number.toString();
      }
    </script>
  </head>

  <body>
    {%- for option in options -%}
    <div>
      <input type="number"
             name="input-{{ option.key }}"
             value="0"
             min="0"
             max="99">
      <h2>{{ option.name | capitalize }}</h2>
    </div>
    {%- endfor -%}

    <div id="text"></div>

    <a href="https://twitter.com/intent/tweet"
       id="tweet"
       target="_blank">Comparte en Twitter</a>
  </body>
</html>
